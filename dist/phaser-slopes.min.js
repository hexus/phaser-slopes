!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Slopes",[],t):"object"==typeof exports?exports.Slopes=t():e.Slopes=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t){var n={};e.exports=n,n.create=function(e,t){return{x:e||0,y:t||0}},n.clone=function(e){return{x:e.x,y:e.y}},n.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},n.rotate=function(e,t,n){var r=Math.cos(t),o=Math.sin(t);n||(n={});var i=e.x*r-e.y*o;return n.y=e.x*o+e.y*r,n.x=i,n},n.rotateAbout=function(e,t,n,r){var o=Math.cos(t),i=Math.sin(t);r||(r={});var a=n.x+((e.x-n.x)*o-(e.y-n.y)*i);return r.y=n.y+((e.x-n.x)*i+(e.y-n.y)*o),r.x=a,r},n.normalise=function(e){var t=n.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},n.dot=function(e,t){return e.x*t.x+e.y*t.y},n.cross=function(e,t){return e.x*t.y-e.y*t.x},n.cross3=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)},n.add=function(e,t,n){return n||(n={}),n.x=e.x+t.x,n.y=e.y+t.y,n},n.sub=function(e,t,n){return n||(n={}),n.x=e.x-t.x,n.y=e.y-t.y,n},n.mult=function(e,t){return{x:e.x*t,y:e.y*t}},n.div=function(e,t){return{x:e.x/t,y:e.y/t}},n.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},n.neg=function(e){return{x:-e.x,y:-e.y}},n.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]},function(e,t,n){
/**
 * @author       Richard Davey <rich@photonstorm.com>
 * @copyright    2020 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
var r=n(5);e.exports=function(e,t,n,o){if(void 0===n&&(n=!1),r(e,t,o)){var i=o.data[t][e]||null;return i?-1===i.index?n?i:null:i:null}return null}},function(e,t,n){var r={};e.exports=r;var o=n(0),i=n(4);r.create=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r],i={x:o.x,y:o.y,index:r,body:t,isInternal:!1};n.push(i)}return n},r.fromPath=function(e,t){var n=[];return e.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,(function(e,t,r){n.push({x:parseFloat(t),y:parseFloat(r)})})),r.create(n,t)},r.centre=function(e){for(var t,n,i,a=r.area(e,!0),s={x:0,y:0},l=0;l<e.length;l++)i=(l+1)%e.length,t=o.cross(e[l],e[i]),n=o.mult(o.add(e[l],e[i]),t),s=o.add(s,n);return o.div(s,6*a)},r.mean=function(e){for(var t={x:0,y:0},n=0;n<e.length;n++)t.x+=e[n].x,t.y+=e[n].y;return o.div(t,e.length)},r.area=function(e,t){for(var n=0,r=e.length-1,o=0;o<e.length;o++)n+=(e[r].x-e[o].x)*(e[r].y+e[o].y),r=o;return t?n/2:Math.abs(n)/2},r.inertia=function(e,t){for(var n,r,i=0,a=0,s=e,l=0;l<s.length;l++)r=(l+1)%s.length,i+=(n=Math.abs(o.cross(s[r],s[l])))*(o.dot(s[r],s[r])+o.dot(s[r],s[l])+o.dot(s[l],s[l])),a+=n;return t/6*(i/a)},r.translate=function(e,t,n){n=void 0!==n?n:1;var r,o=e.length,i=t.x*n,a=t.y*n;for(r=0;r<o;r++)e[r].x+=i,e[r].y+=a;return e},r.rotate=function(e,t,n){if(0!==t){var r,o,i,a,s=Math.cos(t),l=Math.sin(t),c=n.x,u=n.y,p=e.length;for(a=0;a<p;a++)o=(r=e[a]).x-c,i=r.y-u,r.x=c+(o*s-i*l),r.y=u+(o*l+i*s);return e}},r.contains=function(e,t){for(var n,r=t.x,o=t.y,i=e.length,a=e[i-1],s=0;s<i;s++){if(n=e[s],(r-a.x)*(n.y-a.y)+(o-a.y)*(a.x-n.x)>0)return!1;a=n}return!0},r.scale=function(e,t,n,i){if(1===t&&1===n)return e;var a,s;i=i||r.centre(e);for(var l=0;l<e.length;l++)a=e[l],s=o.sub(a,i),e[l].x=i.x+s.x*t,e[l].y=i.y+s.y*n;return e},r.chamfer=function(e,t,n,r,a){t="number"==typeof t?[t]:t||[8],n=void 0!==n?n:-1,r=r||2,a=a||14;for(var s=[],l=0;l<e.length;l++){var c=e[l-1>=0?l-1:e.length-1],u=e[l],p=e[(l+1)%e.length],d=t[l<t.length?l:t.length-1];if(0!==d){var y=o.normalise({x:u.y-c.y,y:c.x-u.x}),f=o.normalise({x:p.y-u.y,y:u.x-p.x}),h=Math.sqrt(2*Math.pow(d,2)),x=o.mult(i.clone(y),d),m=o.normalise(o.mult(o.add(y,f),.5)),g=o.sub(u,o.mult(m,h)),v=n;-1===n&&(v=1.75*Math.pow(d,.32)),(v=i.clamp(v,r,a))%2==1&&(v+=1);for(var b=Math.acos(o.dot(y,f))/v,w=0;w<v;w++)s.push(o.add(o.rotate(x,b*w),g))}else s.push(u)}return s},r.clockwiseSort=function(e){var t=r.mean(e);return e.sort((function(e,n){return o.angle(t,e)-o.angle(t,n)})),e},r.isConvex=function(e){var t,n,r,o,i=0,a=e.length;if(a<3)return null;for(t=0;t<a;t++)if(r=(t+2)%a,o=(e[n=(t+1)%a].x-e[t].x)*(e[r].y-e[n].y),(o-=(e[n].y-e[t].y)*(e[r].x-e[n].x))<0?i|=1:o>0&&(i|=2),3===i)return!1;return 0!==i||null},r.hull=function(e){var t,n,r=[],i=[];for((e=e.slice(0)).sort((function(e,t){var n=e.x-t.x;return 0!==n?n:e.y-t.y})),n=0;n<e.length;n+=1){for(t=e[n];i.length>=2&&o.cross3(i[i.length-2],i[i.length-1],t)<=0;)i.pop();i.push(t)}for(n=e.length-1;n>=0;n-=1){for(t=e[n];r.length>=2&&o.cross3(r[r.length-2],r[r.length-1],t)<=0;)r.pop();r.push(t)}return r.pop(),i.pop(),r.concat(i)}},function(e,t){var n={};e.exports=n,n.create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&n.update(t,e),t},n.update=function(e,t,n){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var r=0;r<t.length;r++){var o=t[r];o.x>e.max.x&&(e.max.x=o.x),o.x<e.min.x&&(e.min.x=o.x),o.y>e.max.y&&(e.max.y=o.y),o.y<e.min.y&&(e.min.y=o.y)}n&&(n.x>0?e.max.x+=n.x:e.min.x+=n.x,n.y>0?e.max.y+=n.y:e.min.y+=n.y)},n.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},n.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},n.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},n.shift=function(e,t){var n=e.max.x-e.min.x,r=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+n,e.min.y=t.y,e.max.y=t.y+r}},function(e,t,n){(function(t){var n={};e.exports=n,function(){n._nextId=0,n._seed=0,n._nowStartTime=+new Date,n._warnedOnce={},n._decomp=null,n.extend=function(e,t){var r,o;"boolean"==typeof t?(r=2,o=t):(r=1,o=!0);for(var i=r;i<arguments.length;i++){var a=arguments[i];if(a)for(var s in a)o&&a[s]&&a[s].constructor===Object?e[s]&&e[s].constructor!==Object?e[s]=a[s]:(e[s]=e[s]||{},n.extend(e[s],o,a[s])):e[s]=a[s]}return e},n.clone=function(e,t){return n.extend({},t,e)},n.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)t.push(n);return t},n.values=function(e){var t=[];if(Object.keys){for(var n=Object.keys(e),r=0;r<n.length;r++)t.push(e[n[r]]);return t}for(var o in e)t.push(e[o]);return t},n.get=function(e,t,n,r){t=t.split(".").slice(n,r);for(var o=0;o<t.length;o+=1)e=e[t[o]];return e},n.set=function(e,t,r,o,i){var a=t.split(".").slice(o,i);return n.get(e,t,0,-1)[a[a.length-1]]=r,r},n.shuffle=function(e){for(var t=e.length-1;t>0;t--){var r=Math.floor(n.random()*(t+1)),o=e[t];e[t]=e[r],e[r]=o}return e},n.choose=function(e){return e[Math.floor(n.random()*e.length)]},n.isElement=function(e){return"undefined"!=typeof HTMLElement?e instanceof HTMLElement:!!(e&&e.nodeType&&e.nodeName)},n.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.isFunction=function(e){return"function"==typeof e},n.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},n.isString=function(e){return"[object String]"===toString.call(e)},n.clamp=function(e,t,n){return e<t?t:e>n?n:e},n.sign=function(e){return e<0?-1:1},n.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-n._nowStartTime},n.random=function(t,n){return n=void 0!==n?n:1,(t=void 0!==t?t:0)+e()*(n-t)};var e=function(){return n._seed=(9301*n._seed+49297)%233280,n._seed/233280};n.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},n.logLevel=1,n.log=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.info=function(){console&&n.logLevel>0&&n.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.warn=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.warnOnce=function(){var e=Array.prototype.slice.call(arguments).join(" ");n._warnedOnce[e]||(n.warn(e),n._warnedOnce[e]=!0)},n.deprecated=function(e,t,r){e[t]=n.chain((function(){n.warnOnce("ðŸ”… deprecated ðŸ”…",r)}),e[t])},n.nextId=function(){return n._nextId++},n.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},n.map=function(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n},n.topologicalSort=function(e){var t=[],r=[],o=[];for(var i in e)r[i]||o[i]||n._topologicalSort(i,r,o,e,t);return t},n._topologicalSort=function(e,t,r,o,i){var a=o[e]||[];r[e]=!0;for(var s=0;s<a.length;s+=1){var l=a[s];r[l]||(t[l]||n._topologicalSort(l,t,r,o,i))}r[e]=!1,t[e]=!0,i.push(e)},n.chain=function(){for(var e=[],t=0;t<arguments.length;t+=1){var n=arguments[t];n._chained?e.push.apply(e,n._chained):e.push(n)}var r=function(){for(var t,n=new Array(arguments.length),r=0,o=arguments.length;r<o;r++)n[r]=arguments[r];for(r=0;r<e.length;r+=1){var i=e[r].apply(t,n);void 0!==i&&(t=i)}return t};return r._chained=e,r},n.chainPathBefore=function(e,t,r){return n.set(e,t,n.chain(r,n.get(e,t)))},n.chainPathAfter=function(e,t,r){return n.set(e,t,n.chain(n.get(e,t),r))},n.setDecomp=function(e){n._decomp=e},n.getDecomp=function(){var e=n._decomp;try{e||"undefined"==typeof window||(e=window.decomp),e||void 0===t||(e=t.decomp)}catch(t){e=null}return e}}()}).call(this,n(7))},function(e,t){e.exports=function(e,t,n){return e>=0&&e<n.width&&t>=0&&t<n.height}},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r);var i={fromVertices:function(e){let t,n,r=[];for(t=0;t<e.length;t++)n=(t+1)%e.length,e[t]&&e[n]?r[t]=o.a.normalise({x:e[n].y-e[t].y,y:e[t].x-e[n].x}):r[t]=null;return r}};let a={preSolvePosition:function(e){let t,n,r,i,a,s,l,c,u,p,d,y={};for(t=0;t<e.length;t++)n=e[t],n.isActive&&(i=!!n.collision.parentA.edges,a=!!n.collision.parentB.edges,i&&!a||!i&&a?(l=i?n.collision.parentA:n.collision.parentB,s=i?n.collision.parentB:n.collision.parentA,n.isActive=!1,y[s.id]||(y[s.id]=[]),y[s.id].push(n)):(r=n.activeContacts.length,n.collision.parentA.totalContacts+=r,n.collision.parentB.totalContacts+=r));for(t in y)if(u=y[t],u.length){for(p=Number.MAX_VALUE,d=null,c=0;c<u.length;c++)n=u[c],n.collision.depth<p&&(p=n.collision.depth,d=n);if(d)for(d.isActive=!0,d.collision.parentA.totalContacts+=d.activeContacts.length,d.collision.parentB.totalContacts+=d.activeContacts.length,c=0;c<u.length;c++){if(n=u[c],n===d)continue;let e=o.a.dot(d.collision.edge.normals[1],n.collision.edge.normals[1])>.99,t=o.a.dot(d.collision.normal,n.collision.normal)>.99,r=o.a.dot(d.collision.normal,n.collision.edge.normals[1])>.99;(e||t||r)&&(n.isActive=!0);let i=o.a.sub(n.collision.edge.position,d.collision.edge.position),a=o.a.dot(i,d.collision.edge.normals[1])>=0,s=o.a.dot(i,n.collision.normal)>=0;(a||s)&&(n.isActive=!0),n.isActive&&(n.collision.parentA.totalContacts+=n.activeContacts.length,n.collision.parentB.totalContacts+=n.activeContacts.length)}}}};var s=a,l=n(2),c=n.n(l);const u=[{min:Number.MAX_VALUE,max:Number.MIN_VALUE},{min:Number.MAX_VALUE,max:Number.MIN_VALUE}],p={create:function(e,t){return{pair:null,collided:!1,bodyA:e,bodyB:t,parentA:e.parent,parentB:t.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},collides:function(e,t,n){let r=p.collideBodies(e,t);return r.collided?(r.supports=p.findCollisionSupports(r),r):null},collideBodies:function(e,t,n){let r,i,a,s,l,c,u,d,y={overlap:Number.MAX_VALUE},f=!1,h=[];if(n){let o=e.parent,i=t.parent,a=o.speed*o.speed+o.angularSpeed*o.angularSpeed+i.speed*i.speed+i.angularSpeed*i.angularSpeed;f=n&&n.collided&&a<.2&&n.axisNumber>=0,r=n}else r=p.create(e,t);if(f=!1,n&&f){let o=r.axisBody,i=o===e?t:e,a=o.axes[n.axisNumber];if(y=p.overlapAxis(o.vertices,i.vertices,a),r.reused=!0,y.overlap<=0)return r.collided=!1,r}else{if(i=!!e.edges,a=!!t.edges,i&&!a||!i&&a){if(l=i?e:t,s=i?t:e,u=p.overlapBodyWithEdges(s,l),u.overlap<=0)return r.collided=!1,r;y.overlap=u.overlap,y.axis=u.axis,y.axisBody=u.axisBody,y.axisNumber=u.axisNumber,y.edge=u.edge,y.flip=u.flip}else{for(c=0;c<e.axes.length;c++){if(u=p.overlapAxis(e.vertices,t.vertices,e.axes[c]),u.overlap<=0)return r.collided=!1,r;u.axisBody=e,u.axisNumber=c,h.push(u)}for(c=0;c<t.axes.length;c++){if(u=p.overlapAxis(t.vertices,e.vertices,t.axes[c]),u.overlap<=0)return r.collided=!1,r;u.axisBody=t,u.axisNumber=c,h.push(u)}for(d=0;d<h.length;d++){if(u=h[d],u.overlap<=0)return r.collided=!1,r;u.overlap<y.overlap&&(y=u)}}r.axisBody=y.axisBody,r.axisNumber=y.axisNumber}return r.bodyA=e.id<t.id?e:t,r.bodyB=e.id<t.id?t:e,r.collided=!0,r.depth=y.overlap,r.edge=y.edge,r.parentA=r.bodyA.parent,r.parentB=r.bodyB.parent,e=r.bodyA,t=r.bodyB,!y.flip&&o.a.dot(y.axis,o.a.sub(t.position,e.position))<0?r.normal={x:y.axis.x,y:y.axis.y}:r.normal={x:-y.axis.x,y:-y.axis.y},r.tangent=o.a.perp(r.normal),r.penetration=r.penetration||{},r.penetration.x=r.normal.x*r.depth,r.penetration.y=r.normal.y*r.depth,r},overlapNormal:function(e,t,n){let r,o=u[0],i=u[1],a={overlap:Number.MAX_VALUE};return p.projectToAxis(o,e,n),p.projectToAxis(i,t,n),o.min>=i.max||i.min>=o.max?(a.overlap=0,a.axis=n,a):(r=i.max-o.min,a.overlap=r,a.axis=n,a)},overlapBodyWithEdges:function(e,t){let n,r,o,i,a,s=[],l={overlap:Number.MAX_VALUE};for(n=0;n<t.edges.length;n++)r=t.edges[n],r.ignore||(o=p.overlapBodyWithEdge(e,t,r),o.overlap<=0||s.push(o));if(!s.length)return l.overlap=0,l;for(i=0;i<s.length;i++)s[i].overlap<l.overlap&&(l=s[i]);return a=t.id<e.id,l.flip=a,l},overlapBodyWithEdge(e,t,n){let r,o,i,a,s=[],l={overlap:Number.MAX_VALUE};if(s[0]=n.vertices[1],s[1]=n.vertices[2],r=n.normalRanges.front,l=p.overlapNormal(e.vertices,s,r.normal),l.overlap<=0)return l;for(l.axisBody=t,l.axisNumber=n.index,l.edge=n,i=0;i<e.axes.length;i++){if(a=e.axes[i],o=p.overlapNormal(e.vertices,s,a),o.overlap<=0)return o;p.isVectorBetween(o.axis,r.lowerLimit,r.upperLimit)&&(o.axisBody=e,o.axisNumber=i,o.edge=n,o.overlap<l.overlap&&(l=o))}return l},isVectorBetween(e,t,n){let r=Math.atan2(e.y,e.x),o=Math.atan2(t.y,t.x),i=Math.atan2(n.y,n.x);const a=2*Math.PI;return r%=a,o%=a,i%=a,r=r>=0?r:r+a,o=o>=0?o:o+a,i=i>=0?i:i+a,o<=i?o<=r&&r<=i:o<=r||r<=i},overlapAxis:function(e,t,n){let r,o=u[0],i=u[1],a={overlap:Number.MAX_VALUE};return p.projectToAxis(o,e,n),p.projectToAxis(i,t,n),r=Math.min(o.max-i.min,i.max-o.min),r<=0?(a.overlap=r,a.axis=n,a):(r<a.overlap&&(a.overlap=r,a.axis=n),a)},projectToAxis:function(e,t,n){let r,i,a=o.a.dot(t[0],n),s=a;for(r=0;r<t.length;r+=1)i=o.a.dot(t[r],n),i<a&&(a=i),i>s&&(s=i);e.min=a,e.max=s},findSupports:function(e,t,n){let r,i,a,s,l,c,u,p=Number.MAX_VALUE,d=o.a._temp[0],y=t.vertices,f=e.position;for(r=0;r<y.length;r++)a=y[r],d.x=a.x-f.x,d.y=a.y-f.y,i=-o.a.dot(n,d),i<p&&(p=i,s=a);return l=s.index-1>=0?s.index-1:y.length-1,a=y[l],d.x=a.x-f.x,d.y=a.y-f.y,p=-o.a.dot(n,d),c=a,u=(s.index+1)%y.length,a=y[u],d.x=a.x-f.x,d.y=a.y-f.y,i=-o.a.dot(n,d),i<p&&(c=a),[s,c]},findCollisionSupports:function(e){let t=e.bodyA,n=e.bodyB,r=p.findSupports(t,n,e.normal),i=[];if(c.a.contains(t.vertices,r[0])&&i.push(r[0]),c.a.contains(t.vertices,r[1])&&i.push(r[1]),i.length<2){let r=p.findSupports(n,t,o.a.neg(e.normal));c.a.contains(n.vertices,r[0])&&i.push(r[0]),i.length<2&&c.a.contains(n.vertices,r[1])&&i.push(r[1])}return i.length<1&&(i=[r[0]]),i}};var d=p,y=n(1),f=n.n(y),h=n(3),x=n.n(h);var m={EMPTY:0,SOLID:1,INTERESTING:2,Directions:{UP:{x:0,y:-1,name:"UP"},DOWN:{x:0,y:1,name:"DOWN"},LEFT:{x:-1,y:0,name:"LEFT"},RIGHT:{x:1,y:0,name:"RIGHT"}}};function g(e){return!(e&&e.physics&&e.physics.matterBody&&e.physics.matterBody.body&&e.physics.matterBody.body.vertices&&e.physics.slopes&&e.physics.slopes.neighbours&&e.physics.slopes.edges)}function v(e,t){return o.a.magnitudeSquared(o.a.sub(e,t))}function b(e,t){let n;for(n=0;n<t.length;n++)if(!t[n].ignore&&1===o.a.dot(e,t[n]))return!0;return!1}function w(e,t,n,r,o){let i={x:t,y:n,index:e,body:r,isInternal:!1,isGhost:o,contact:null};return i.contact={vertex:i,normalImpulse:0,tangentImpulse:0},i}function L(e,t,n,r,a){r=r||null,a=a||null;let s=[];s.push(r?w(0,r.x,r.y,n,!0):null,w(1,e.x,e.y,n),w(2,t.x,t.y,n),a?w(3,a.x,a.y,n,!0):null);let l={vertices:s,normals:null};return l.normals=i.fromVertices(l.vertices),l.position=o.a.create((e.x+t.x)/2,(e.y+t.y)/2),l.index=e.index,l}function M(e){let t,n,r={},i={},a=e.vertices[0],s=e.vertices[1],l=e.vertices[2],c=e.vertices[3],u=!!a,p=!!c,d=o.a.sub(l,s);d=o.a.normalise(d);let y=e.normals[0],f=e.normals[1],h=e.normals[2],x=!1,m=!1;u&&(t=o.a.sub(s,a),t=o.a.normalise(t),x=o.a.cross(t,d)>=0),p&&(n=o.a.sub(c,l),n=o.a.normalise(n),m=o.a.cross(d,n)>=0),u&&p?x&&m?(r.normal=f,r.lowerLimit=y,r.upperLimit=h,i.normal=o.a.neg(f),i.lowerLimit=o.a.neg(f),i.upperLimit=o.a.neg(f)):x?(r.normal=f,r.lowerLimit=y,r.upperLimit=f,i.normal=o.a.neg(f),i.lowerLimit=o.a.neg(h),i.upperLimit=o.a.neg(f)):m?(r.normal=f,r.lowerLimit=f,r.upperLimit=h,i.normal=o.a.neg(f),i.lowerLimit=o.a.neg(f),i.upperLimit=o.a.neg(y)):(r.normal=f,r.lowerLimit=f,r.upperLimit=f,i.normal=o.a.neg(f),i.lowerLimit=o.a.neg(h),i.upperLimit=o.a.neg(y)):u?x?(r.normal=f,r.lowerLimit=y,r.upperLimit=o.a.neg(f),i.normal=o.a.neg(f),i.lowerLimit=f,i.upperLimit=o.a.neg(f)):(r.normal=f,r.lowerLimit=f,r.upperLimit=o.a.neg(f),i.normal=o.a.neg(f),i.lowerLimit=f,i.upperLimit=o.a.neg(y)):p?m?(r.normal=f,r.lowerLimit=o.a.neg(f),r.upperLimit=h,i.normal=o.a.neg(f),i.lowerLimit=o.a.neg(f),i.upperLimit=f):(r.normal=f,r.lowerLimit=o.a.neg(f),r.upperLimit=f,i.normal=o.a.neg(f),i.lowerLimit=o.a.neg(h),i.upperLimit=f):(r.normal=f,r.lowerLimit=o.a.neg(f),r.upperLimit=o.a.neg(f),i.normal=o.a.neg(f),i.lowerLimit=f,i.upperLimit=f),e.convexPrev=x,e.convexNext=m,e.normalRanges={front:r,back:i}}const P={convertTilemapLayer:function(e,t){let n=e.layer,r=e.getTilesWithin(0,0,n.width,n.height,{isColliding:!0});return this.convertTiles(r,t),this.processEdges(e,r),this},processEdges:function(e,t){let n,r=e.layer;for(n in t){let e=t[n];e.physics.slopes=e.physics.slopes||{},e.physics.slopes={neighbours:{up:f()(e.x,e.y-1,!0,r),down:f()(e.x,e.y+1,!0,r),left:f()(e.x-1,e.y,!0,r),right:f()(e.x+1,e.y,!0,r),topLeft:f()(e.x-1,e.y-1,!0,r),topRight:f()(e.x+1,e.y-1,!0,r),bottomLeft:f()(e.x-1,e.y+1,!0,r),bottomRight:f()(e.x+1,e.y+1,!0,r)},edges:{top:m.INTERESTING,bottom:m.INTERESTING,left:m.INTERESTING,right:m.INTERESTING}}}this.calculateBoundaryEdges(t),this.flagInternalEdges(t),this.flagIgnormals(t)},calculateBoundaryEdges:function(e){let t,n,r,i=o.a._temp[0],a=o.a._temp[1],s=o.a._temp[2],l=o.a._temp[3];for(t=0;t<e.length;t++){if(n=e[t],g(n))continue;let o=n.physics.matterBody.body.vertices,c=n.pixelX,u=n.pixelX+n.width,p=n.pixelY,d=n.pixelY+n.height;for(i.y=p,i.x=c,a.y=p,a.x=u,s.y=d,s.x=c,l.y=d,l.x=u,r=0;r<o.length;r++){let e=o[r],t=o[(r+1)%o.length];v(e,i)<5&&v(t,a)<5&&(n.physics.slopes.edges.top=m.SOLID),v(e,l)<5&&v(t,s)<5&&(n.physics.slopes.edges.bottom=m.SOLID),v(e,s)<5&&v(t,i)<5&&(n.physics.slopes.edges.left=m.SOLID),v(e,a)<5&&v(t,l)<5&&(n.physics.slopes.edges.right=m.SOLID)}}for(t=0;t<e.length;t++){if(n=e[t],g(n))continue;let r=n.physics.slopes.edges,o=n.physics.slopes.neighbours,i=o.up,a=o.down,s=o.left,l=o.right;g(i)||(r.top=this.compareBoundaryEdges(r.top,i.physics.slopes.edges.bottom),n.collideUp=r.top!==m.EMPTY),g(a)||(r.bottom=this.compareBoundaryEdges(r.bottom,a.physics.slopes.edges.top),n.collideDown=r.bottom!==m.EMPTY),g(s)||(r.left=this.compareBoundaryEdges(r.left,s.physics.slopes.edges.right),n.collideLeft=r.left!==m.EMPTY),g(l)||(r.right=this.compareBoundaryEdges(r.right,l.physics.slopes.edges.left),n.collideRight=r.right!==m.EMPTY)}},compareBoundaryEdges:function(e,t){return e===m.SOLID&&t===m.SOLID||e===m.SOLID&&t===m.EMPTY?m.EMPTY:e},flagInternalEdges:function(e){const t=["up","down","left","right"];let n,r,i,a,s,l,c,u,p,d;for(n=0;n<e.length;n++){if(r=e[n],g(r))continue;let y=r.physics.matterBody.body,f=y.vertices;for(i in t){if(a=r.physics.slopes.neighbours[t[i]],g(a))continue;let e=a.physics.matterBody.body,n=e.vertices;if(x.a.overlaps(y.bounds,e.bounds))for(c=f,u=n,p=y.axes,d=e.axes,s=0;s<c.length;s++)for(l=0;l<u.length;l++){let e=o.a.magnitudeSquared(o.a.sub(c[(s+1)%c.length],u[l])),t=o.a.magnitudeSquared(o.a.sub(c[s],u[(l+1)%u.length]));e<5&&t<5&&(c[s].isInternal=!0,u[l].isInternal=!0,p[s].ignore=!0,d[l].ignore=!0)}}}},flagIgnormals:function(e){let t,n,r,a,s,l,c,u,p,d,y,f,h,P,A,E,S;for(t=0;t<e.length;t++)if(n=e[t],!g(n)){for(r=n.physics.matterBody.body,a=r.vertices,r.edges=[],r.ignormals=[],p=0;p<a.length;p++)f=a[p],h=a[(p+1)%a.length],S=r.edges[p],S=L(f,h,r),S.ignore=f.isInternal,r.edges[p]=S;for(s in n.physics.slopes.neighbours)if(l=n.physics.slopes.neighbours[s],!g(l)&&(c=l.physics.matterBody.body,u=c.vertices,x.a.overlaps(r.bounds,c.bounds)))for(p=0;p<a.length;p++)for(f=a[p],h=a[(p+1)%a.length],S=r.edges[p],d=0;d<u.length;d++){if(A=u[d],E=u[(d+1)%u.length],A.isInternal)continue;let e=v(f,E)<5,t=v(h,A)<5;if(e||t){e&&!S.vertices[0]&&(S.vertices[0]=w(0,A.x,A.y,r,!0),c.edges&&(S.prev=c.edges[d],c.edges[d].next=S)),t&&!S.vertices[3]&&(S.vertices[3]=w(3,E.x,E.y,r,!0));let n=e?E:A,i=r.axes[p],a=c.axes[d];o.a.dot(i,a)>0&&(Math.abs(n.x-r.bounds.min.x)<1&&!b(m.Directions.LEFT,r.axes)&&o.a.dot(i,m.Directions.LEFT)<1&&o.a.dot(a,m.Directions.LEFT)<1&&r.ignormals.push(m.Directions.LEFT),Math.abs(n.y-r.bounds.min.y)<1&&!b(m.Directions.UP,r.axes)&&o.a.dot(i,m.Directions.UP)<1&&o.a.dot(a,m.Directions.UP)<1&&r.ignormals.push(m.Directions.UP),Math.abs(n.x-r.bounds.max.x)<1&&!b(m.Directions.RIGHT,r.axes)&&o.a.dot(i,m.Directions.RIGHT)<1&&o.a.dot(a,m.Directions.RIGHT)<1&&r.ignormals.push(m.Directions.RIGHT),Math.abs(n.y-r.bounds.max.y)<1&&!b(m.Directions.DOWN,r.axes)&&o.a.dot(i,m.Directions.DOWN)<1&&o.a.dot(a,m.Directions.DOWN)<1&&r.ignormals.push(m.Directions.DOWN))}}for(p=0;p<a.length;p++)S=r.edges[p],S.ignore||(y=a[((p-1)%a.length+a.length)%a.length],f=a[p],h=a[(p+1)%a.length],P=a[(p+2)%a.length],S.vertices[0]||y.isInternal||(S.vertices[0]=w(0,y.x,y.y,r,!0)),S.vertices[3]||h.isInternal||(S.vertices[3]=w(3,P.x,P.y,r,!0)),S.normals=i.fromVertices(S.vertices),M(S))}}};var A={Matter:{Axes:i,Resolver:s,SAT:d,World:P}};class E{constructor(e){this.scene=e,this.overridden={}}boot(){let e=this.scene.sys.events;e.on("start",this.start,this),e.on("shutdown",this.shutdown,this),e.on("destroy",this.destroy,this),this.start()}start(){if(!Phaser||!Phaser.Physics||!Phaser.Physics.Matter)return void console.warn("Phaser Slopes plugin could not find Phaser or Matter.js during start up");let e=Phaser.Physics.Matter.Matter.Axes,t=Phaser.Physics.Matter.Matter.Resolver,n=Phaser.Physics.Matter.Matter.Collision,r=Phaser.Physics.Matter.World;console.log(r,n,e,t),this.overridden.convertTilemapLayer=r.prototype.convertTilemapLayer,this.overridden.processEdges=r.prototype.processEdges,this.overridden.collides=n.collides,this.overridden.fromVertices=e.fromVertices,this.overridden.solvePosition=t.solvePosition,this.overridden.preSolvePosition=t.preSolvePosition,e.fromVertices=A.Matter.Axes.fromVertices,t.preSolvePosition=A.Matter.Resolver.preSolvePosition,n.collides=A.Matter.SAT.collides,r.prototype.convertTilemapLayer=A.Matter.World.convertTilemapLayer,r.prototype.processEdges=A.Matter.World.processEdges,r.prototype.calculateBoundaryEdges=A.Matter.World.calculateBoundaryEdges,r.prototype.compareBoundaryEdges=A.Matter.World.compareBoundaryEdges,r.prototype.flagInternalEdges=A.Matter.World.flagInternalEdges,r.prototype.flagIgnormals=A.Matter.World.flagIgnormals}shutdown(){if(!Phaser||!Phaser.Physics)return void console.warn("Phaser Slopes plugin could not find Phaser during shutdown");let e=Phaser.Physics.Matter.Matter.Axes,t=Phaser.Physics.Matter.Matter.Resolver,n=Phaser.Physics.Matter.Matter.Collision,r=Phaser.Physics.Matter.World;e.fromVertices=this.overridden.fromVertices,t.preSolvePosition=this.overridden.preSolvePosition,t.solvePosition=this.overridden.solvePosition,n.collides=this.overridden.collides,r.prototype.convertTilemapLayer=this.overridden.convertTilemapLayer,r.prototype.processEdges=this.overridden.processEdges,delete r.prototype.calculateBoundaryEdges,delete r.prototype.compareBoundaryEdges,delete r.prototype.flagInternalEdges,delete r.prototype.flagIgnormals}destroy(){this.shutdown(),this.scene=null,this.overridden=null}}Phaser=Phaser||{},Phaser.Plugins=Phaser.Plugins||{},Phaser.Plugins.Slopes=E;t.default=E},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}]).default}));